/*! templateLoader 26-04-2014 */
!function(a,b){"use strict";"function"==typeof window.define&&window.define.amd?window.define(["jquery","handlebars"],b):window.templateLoader=b(window.jQuery,window.Handlebars)}(this,function(a,b){"use strict";var c={options:{templateUrlRoot:"/templates/",templateExt:".handlebars.html",templateLotSelectorId:"templates"},setup:function(b){a.extend(this.options,b)},requestedTemplates:{},getSingleTemplate:function(c){var d,e=a("#"+c),f=a.Deferred(),g=this;if(b.templates||(b.templates={}),b.templates[c])f.resolve(b.templates[c],c);else if(e.length)b.templates[c]=d=b.compile(e.html()),f.resolve(d,c);else{if(this.requestedTemplates[c])return this.requestedTemplates[c];this.requestedTemplates[c]=f,this.getTmplOverAjax(c).done(function(a){e=g.ajaxHandler(a,c),f.resolve(e,c)})}return f},getTmplOverAjax:function(b){var c=this.options.templateUrlRoot+b+this.options.templateExt;return a.ajax({url:c})},ajaxHandler:function(c,d){var e,f=this.getTemplatesLot(),g=a("<script>",{id:d,type:"text/x-handlebars-template"});return g.text(c),f.append(g),b.templates[d]=e=b.compile(c),this.requestedTemplates[d]&&(this.requestedTemplates[d]=null),e},getTemplatesLot:function(){var b=a("#"+this.options.templateLotSelectorId);return b.length||(b=a("<div>",{id:this.options.templateLotSelectorId}),a("body").append(b)),b},getPartials:function(a){var b,c,d,e,f=[];for(b=0,c=a.length;c>b;b+=1)e=a[b],d=this.getSingleTemplate(e),d.done(this.registerPartial),f.push(d);return f},registerPartial:function(a,c){b.registerPartial(c,a)},get:function(b,c){if(!c||!c.length)return this.getSingleTemplate(b);var d,e=a.Deferred();return d=this.getPartials(c),d.push(this.getSingleTemplate(b,!0)),a.when.apply(this,d).done(function(){var a=arguments[arguments.length-1];e.resolve.apply(e,a)}),e}};return c});